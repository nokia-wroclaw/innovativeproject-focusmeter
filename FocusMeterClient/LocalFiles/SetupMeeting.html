<!DOCTYPE html>
<!--
*Panel For Creating and Setting up the new Meeting in Focus Meter System
*author: Maciej Baj

-->
<html>
    <head>
        <meta name="viewport" content="width=320, user-scalable=no">
        <meta http-equiv="Content-type" content="text/html; charset=utf-8">
        <title>Focus Meter</title>
        <link rel="stylesheet" href="./css/bootstrap.css" type="text/css">
        <link rel="stylesheet" href="./js/jquery-ui.css" type="text/css" media="screen" title="no title">
        <link rel="stylesheet" href="./js/jquery.ptTimeSelect.css" type="text/css" media="screen" title="no title">
        
    </head>
<body>


    <div class="row">
        <div class="col-sm-offset-4 col-sm-4 .col-xs-12">
            <div class="jumbotron">
                <h1>Focus Meter</h1>
                <p>Create new meeting</p>
            </div>

        </div>
    </div>
    <br />
    <div class="row">
        <h3 class="col-sm-offset-4 col-sm-1 col-xs-offset-1 col-xs-2" style="color: whitesmoke; font-size: medium; text-align: right; ">Code:</h3>
    </div>
    <div class="row col-sm-offset-4 col-xs-offset-1">
        <input class="col-sm-1 col-xs-2 input enter-code-field" readonly maxlength="1" required type="text" id="code_1">


        <input class="col-sm-1 col-xs-2 input enter-code-field" readonly maxlength=" 1" required type="text" id="code_2">

        <input class="col-sm-1 col-xs-2 input enter-code-field" readonly maxlength="1" required type="text" id="code_3">


        <input class="col-sm-1 col-xs-2  input enter-code-field" readonly maxlength="1" required type="text" id="code_4">


        <input class="col-sm-1 col-xs-2  input enter-code-field" readonly maxlength="1" required type="text" id="code_5">

    </div>

    <div class="row">
        <h3 class="col-sm-offset-4 col-sm-1 col-xs-offset-1 col-xs-5" style="color: whitesmoke; font-size: medium;">Admin code:</h3>
    </div>
    <div class="row col-sm-offset-4 col-xs-offset-1">
        <input class="col-sm-1 col-xs-2 input enter-code-field" readonly maxlength="1" required type="text" id="adminCode_1">


        <input class="col-sm-1 col-xs-2 input enter-code-field" readonly maxlength=" 1" required type="text" id="adminCode_2">

        <input class="col-sm-1 col-xs-2 input enter-code-field" readonly maxlength="1" required type="text" id="adminCode_3">


        <input class="col-sm-1 col-xs-2  input enter-code-field" readonly maxlength="1" required type="text" id="adminCode_4">


        <input class="col-sm-1 col-xs-2  input enter-code-field" readonly maxlength="1" required type="text" id="adminCode_5">

    </div>

    <br />

    <div class="row">
        <h3 class="col-sm-offset-4 col-sm-1 col-xs-offset-1 col-xs-2" style="color: whitesmoke; font-size: medium; text-align: right; ">Title:</h3>
        <input class="col-sm-3 col-xs-8 input-lg"  type="text" id="title" style="text-align: center" value="" maxlength="40" placeholder="Enter your presentation title"required />
    </div><br />
    <div class="row">
        <h3 class="col-sm-offset-4 col-sm-1 col-xs-offset-1 col-xs-2" style="color: whitesmoke; font-size: medium; text-align: right; ">Date:</h3>
        <input class="col-sm-3 col-xs-8 input-lg" type="text" id="datepicker" style="text-align: center" autocomplete="off" name="Date" maxlength="10" required />
        <!--<input class="col-sm-3 col-xs-8 input-lg" type="date" autocomplete="off" style="text-align: center" name="date" maxlength="10" required />-->
    </div><br />
    <!--<div class="row">
        <h3 class="col-sm-offset-4 col-sm-1 col-xs-offset-1 col-xs-2" style="color: whitesmoke; font-size: medium; text-align: right; ">From</h3>
<<<<<<< HEAD
        <!--<input class="col-sm-1 col-xs-3 input-lg" type="text" id="startHour" autocomplete="off"  name="Hour" maxlength="8" required />-->
        <!--<input class="col-sm-1 col-xs-3 input-lg" type="time"  autocomplete="off" name="time" maxlength="8" required />

        <h3 class="col-sm-1 col-xs-2" style="color: whitesmoke; font-size: medium; text-align: center;">To</h3>
        <!--<input class="col-sm-1 col-xs-3 input-lg" type="text" id="endHour" autocomplete="off"  name="Hour" maxlength="8" required />-->
       <!-- <input class="col-sm-1 col-xs-3 input-lg" type="time" autocomplete="off" name="time" maxlength="8" required />
=======
        <input class="col-sm-1 col-xs-3 input-lg" type="text" id="startHour" autocomplete="off"  name="startHour" maxlength="8" required />

        <h3 class="col-sm-1 col-xs-2" style="color: whitesmoke; font-size: medium; text-align: center;">To</h3>
        <input class="col-sm-1 col-xs-3 input-lg" type="text" id="endHour" autocomplete="off"  name="endHour" maxlength="8" required />
>>>>>>> ef6143b436b25611827e3cf209dc563fce86f02b

    </div>-->
    <div class="row">
        <div class="col-sm-offset-4 col-sm-4 .col-xs-12">
            <br />
            <div id="message-box" style="color: #fff"></div>
            <input type="submit" class="btn btn-lg btn-success btn-block" value="CREATE" />
            <br />
            <input type="button" class="btn btn-lg btn-warning btn-block" onclick="goBackToStartScreen()" value="CANCEL" />
        </div>
    </div>




            <script src="./js/jquery-1.8.2.js"></script>
            <script src="./js/jquery-ui-1.8.20.js"></script>
            <script src="./js/jquery.ptTimeSelect.js"></script>
            <script src="./js/formValidation/jqBootstrapValidation.js"></script>
            <script type="text/javascript">

                //function CenterHourPicker() {
                //    $("#ptTimeSelectCntr").css({ "position": "relative", "left": "50px", "top": "50px" });
                //}

                $(function () {
                    $("#title , #datepicker, #startHour, #endHour").jqBootstrapValidation();
                });

                function goBackToStartScreen() {
                    window.location = './index.html';
                }


                $(document).ready(function () {


                        
                    $('#datepicker').datepicker({
                        dateFormat: 'dd/mm/yy',
                        //showWeek: true,
                        minDate: "0",
                        maxDate: "20Y",
                        showAnim: "bounce",
                        hide: "explode",
                        showButtonPanel: true
                        //}).val();
                    });

                    $('#startHour').ptTimeSelect({
                        containerClass: "timeCntr",
                        containerWidth: "350px",
                        setButtonLabel: "Select",
                        minutesLabel: "min",
                        hoursLabel: "Hrs",

                    });

                    $('#endHour').ptTimeSelect();


                    $(".btn-success").click(function () {
                        var date = $("#datepicker").val();

                        var title = $("#title").val();

                        var startHour = $("#startHour").val();

                        var endHour = $("#endHour").val();

                        var mac = "12-32-43-54-65-76";

                        //check data using regular expressions
                        //var reHour = /^[0,1]*[0-9]:[0-5][0-9]\s[a,p,A,P][m,M]$/;
                        var reDate = /^[0-2][0-9]\/[0,1][0-9]\/2[0-9]{3}$/;
                        var reTitle = /^.{2,40}$/;
                        var correct = true;

                        // if(!reHour.test(startHour))
                        // {
                        //     correct = false;
                        // }

                        // if(!reHour.test(endHour))
                        // {
                        //     correct = false;
                        // }

                        if(!reDate.test(date))
                        {
                            correct = false;
                        }

                        if(!reTitle.test(title))
                        {
                            correct = false;
                        }
                     
                        if(correct)
                        {
                            $("#message-box").text('');
                        }
                        else
                        {
                            //if test fails, ajax will not be sent
                            $("#message-box").text('Please verify and correct data you have entered!');
                            return false;
                        }

                        $.ajax({
                            type: "POST",
                            url: "http://antivps.pl:3033/meeting",
                            data: {
                                "date": date,
                                "title": title,
                                "startHour": startHour,
                                "endHour": endHour,
                                "mac": mac
                            },
                            processData: true,
                            success: function (data) {
                                if(!('meetingCode' in data)) {
                                    alert(JSON.stringify(data));
                                }
                                alert("Utworzono spotkanie! Kod spotkania: " + data.meetingCode + ", kod admina: " + data.adminCode);
                                $("#code_1").val(data.meetingCode.charAt(0));
                                $("#code_2").val(data.meetingCode.charAt(1));
                                $("#code_3").val(data.meetingCode.charAt(2));
                                $("#code_4").val(data.meetingCode.charAt(3));
                                $("#code_5").val(data.meetingCode.charAt(4));

                                $("#adminCode_1").val(data.adminCode.charAt(0));
                                $("#adminCode_2").val(data.adminCode.charAt(1));
                                $("#adminCode_3").val(data.adminCode.charAt(2));
                                $("#adminCode_4").val(data.adminCode.charAt(3));
                                $("#adminCode_5").val(data.adminCode.charAt(4));

                                if (typeof (Storage) != "undefined") {
                                    localStorage.setItem("meetingCodeControl", data.adminCode);

                                    localStorage.setItem("MeetingCode", data.meetingCode);
                                }

                                window.location = './ControlMeeting.html';

                            },
                            error: function (jqXHR, textStatus, errorThrown) {
                                alert("Error, status: " + textStatus + ", errorThrown: " + errorThrown);
                            }
                        });
                    });
                });



            </script>

</body>
</html>


